{% extends "crawler_app/base.html" %}

{% block content %}

<h1>Dashboard</h1>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
{% endif %}

<!-- âœ… CRAWL BUTTON -->
<a href="{% url 'start_crawl' %}" class="btn btn-primary mb-3">
    ğŸ” Neue Seite crawlen
</a>

<!-- âœ… DELETE REQUEST BUTTON -->
<a href="{% url 'request_delete' %}" class="btn btn-danger mb-3">
    âŒ LÃ¶schanfrage an Admin senden
</a>

<h2>Deine Crawl-Ergebnisse</h2>

{% if results %}
<table class="table table-striped">
    <thead>
        <tr>
            <th>URL</th>
            <th>Titel</th>
            <th>Status</th>
            <th>Links</th>
            <th>Datum</th>
        </tr>
    </thead>
    <tbody>
        {% for r in results %}
        <tr>
            <td>{{ r.url }}</td>
            <td>{{ r.title }}</td>
            <td>{{ r.status_code }}</td>
            <td>{{ r.link_count }}</td>
            <td>{{ r.crawled_at }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>Noch keine Ergebnisse.</p>
{% endif %}

<hr>

<h2>AktivitÃ¤tsâ€‘Log</h2>

<div style="max-height: 300px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 5px;">
    {% for log in logs %}
        <div><strong>{{ log.created_at|date:"H:i:s" }}</strong> â€” {{ log.message }}</div>
    {% empty %}
        <p>Noch keine AktivitÃ¤ten.</p>
    {% endfor %}
</div>

{% endblock %}
